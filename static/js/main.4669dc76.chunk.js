(this["webpackJsonpmesto-react"]=this["webpackJsonpmesto-react"]||[]).push([[0],{16:function(e,t,n){"use strict";n.r(t);var a=n(1),i=n.n(a),s=n(9),r=n.n(s),c=(n(8),n(10)),o=n(2),l=n.p+"static/media/logo.bbe2a6ea.svg",u=n(0);var p=function(){return Object(u.jsx)("header",{className:"header",children:Object(u.jsx)("img",{src:l,alt:"\u041b\u043e\u0433\u043e\u0442\u0438\u043f",className:"header__logo"})})},d=i.a.createContext(),h=n.p+"static/media/edit-avatar.a086f758.svg";function _(e){var t=i.a.useContext(d),n=e.card,a=n.owner._id===t._id,s=n.likes.some((function(e){return e._id===t._id})),r="elements__trash-btn ".concat(a?"elements__trash-btn_visible":"elements__trash-btn_hidden"),c="elements__like ".concat(s&&"elements__like_active");return Object(u.jsxs)("div",{className:"elements__place",children:[Object(u.jsx)("img",{className:"elements__photo",alt:n.name,src:n.link,onClick:function(){e.onCardClick(n)}}),Object(u.jsxs)("div",{className:"elements__name-like",children:[Object(u.jsx)("h2",{className:"elements__title",children:n.name}),Object(u.jsxs)("div",{className:"elements__info-like",children:[Object(u.jsx)("button",{type:"button",onClick:function(){e.onCardLike(n)},className:c}),Object(u.jsx)("p",{className:"elements__like-value",children:n.likes.length})]})]}),Object(u.jsx)("button",{type:"button",onClick:function(){e.onCardDelete(n)},className:r})]})}var f=function(e){var t=e.cards,n=e.onCardDelete,a=e.onCardLike,s=e.onHoverAvatar,r=e.isHover,c=e.isVisible,o=e.onEditAvatar,l=e.onEditProfile,p=e.onAddPlace,f=i.a.useContext(d);function m(t){e.isCardOpen(t)}var j=t.map((function(e){return Object(u.jsx)(_,{card:e,onCardDelete:n,onCardLike:a,onCardClick:m},e._id)}));return Object(u.jsxs)("main",{className:"content page__container",children:[Object(u.jsxs)("section",{className:"profile",children:[Object(u.jsxs)("div",{className:"profile__container",children:[Object(u.jsxs)("div",{className:"profile__change",onMouseOver:s,onMouseOut:s,children:[Object(u.jsx)("img",{src:f.avatar,alt:"\u0410\u0432\u0430\u0442\u0430\u0440",className:"profile__avatar ".concat(r?"profile__avatar_opacity":"")}),Object(u.jsx)("img",{src:h,alt:"\u0418\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440",className:"profile__edit-avatar ".concat(c?"profile__edit-avatar_visible":""),onClick:o})]}),Object(u.jsxs)("div",{className:"profile__into",children:[Object(u.jsxs)("div",{className:"profile__username-btn",children:[Object(u.jsx)("h1",{className:"profile__username",children:f.name}),Object(u.jsx)("button",{type:"button",className:"profile__edit-btn",onClick:l})]}),Object(u.jsx)("p",{className:"profile__info",children:f.about})]})]}),Object(u.jsx)("button",{type:"button",className:"profile__add-btn",onClick:p})]}),Object(u.jsx)("section",{className:"elements",children:0!==t.length&&Object(u.jsx)(u.Fragment,{children:j})})]})};var m=function(){return Object(u.jsx)("footer",{className:"footer page__container",children:Object(u.jsx)("p",{className:"footer__copyright",children:"\xa9 2021 Mesto Russia"})})},j="popup_opened",b={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__save",inputErrorClass:"popup__input_type_error",errorActiveClass:"popup__input-error_active"};var v=function(e){return Object(u.jsx)("div",{className:"popup-img popup ".concat(e.isOpen?j:""),onClick:e.handleOverlay,children:Object(u.jsxs)("div",{className:"popup-img__container",children:[Object(u.jsx)("img",{className:"popup-img__image",src:e.card.link,alt:e.card.name}),Object(u.jsx)("h2",{className:"popup-img__title",children:e.card.name}),Object(u.jsx)("button",{type:"button",className:"popup-img__close close-btn",onClick:e.onClose})]})})},O=n(5),x=n(6),k=new(function(){function e(t){Object(O.a)(this,e),this._headers=t.headers,this._url=t.baseUrl}return Object(x.a)(e,[{key:"_handleResponse",value:function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status,", \u043f\u0440\u043e\u0432\u0435\u0440\u044c\u0442\u0435 URL"))}},{key:"getInitialCards",value:function(){return fetch("".concat(this._url,"/cards"),{headers:this._headers}).then(this._handleResponse)}},{key:"getUserData",value:function(){return fetch("".concat(this._url,"/users/me"),{headers:this._headers}).then(this._handleResponse)}},{key:"editProfile",value:function(e){return fetch("".concat(this._url,"/users/me"),{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e.name,about:e.about})}).then(this._handleResponse)}},{key:"editAvatar",value:function(e){return fetch("".concat(this._url,"/users/me/avatar"),{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e.avatar})}).then(this._handleResponse)}},{key:"addNewCardServer",value:function(e){return fetch("".concat(this._url,"/cards"),{method:"POST",headers:this._headers,body:JSON.stringify({name:e.name,link:e.link})}).then(this._handleResponse)}},{key:"putLikeCard",value:function(e){return fetch("".concat(this._url,"/cards/likes/").concat(e),{method:"PUT",headers:this._headers}).then(this._handleResponse)}},{key:"deleteLikeCard",value:function(e){return fetch("".concat(this._url,"/cards/likes/").concat(e),{method:"DELETE",headers:this._headers}).then(this._handleResponse)}},{key:"changeLikeCardStatus",value:function(e,t){return fetch("".concat(this._url,"/cards/likes/").concat(e),{method:t?"PUT":"DELETE",headers:this._headers}).then(this._handleResponse)}},{key:"deleteCard",value:function(e){return fetch("".concat(this._url,"/cards/").concat(e),{method:"DELETE",headers:this._headers}).then(this._handleResponse)}}]),e}())({baseUrl:"https://mesto.nomoreparties.co/v1/cohort-25",headers:{authorization:"ae96c89c-0c63-4b1c-b822-1b0fac9d9184","Content-Type":"application/json"}}),g=function(){function e(t,n){Object(O.a)(this,e),this._config=t,this._formElement=n,this._inputList=Array.from(this._formElement.querySelectorAll(this._config.inputSelector)),this._buttonElement=this._formElement.querySelector(this._config.submitButtonSelector)}return Object(x.a)(e,[{key:"enableValidation",value:function(){this._setEventListeners()}},{key:"_setEventListeners",value:function(){var e=this;this._formElement.addEventListener("submit",(function(e){e.preventDefault()})),this._inputList.forEach((function(t){t.addEventListener("input",(function(){e._checkInputValidity(t),e.toggleButtonState()}))})),this.toggleButtonState()}},{key:"_checkInputValidity",value:function(e){e.validity.valid?this.hideInputError(e):this._showInputError(e)}},{key:"hideInputError",value:function(e){var t=this._formElement.querySelector("#".concat(e.id,"-error"));e.classList.remove(this._config.inputErrorClass),t.classList.remove(this._config.errorActiveClass),t.textContent=""}},{key:"_showInputError",value:function(e){var t=this._formElement.querySelector("#".concat(e.id,"-error"));e.classList.add(this._config.inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._config.errorActiveClass)}},{key:"_hasInvalidInput",value:function(){return this._inputList.some((function(e){return!e.validity.valid}))}},{key:"toggleButtonState",value:function(){this._hasInvalidInput(this._inputList)?this._buttonElement.disabled=!0:this._buttonElement.disabled=!1}}]),e}();var C=function(e){var t=i.a.useRef();return i.a.useEffect((function(){new g(b,t.current).enableValidation()}),[]),Object(u.jsx)("div",{className:"popup popup-".concat(e.name," ").concat(e.isOpen?j:""),onClick:e.handleOverlay,children:Object(u.jsxs)("div",{className:"popup__container container-profile",children:[Object(u.jsx)("button",{type:"button",className:"popup__close",onClick:e.onClose}),Object(u.jsx)("h2",{className:"popup__title",children:e.title}),Object(u.jsxs)("form",{ref:t,onSubmit:e.onSubmit,className:"popup__form form-".concat(e.name),name:"form-".concat(e.name),children:[e.children,Object(u.jsx)("button",{type:"submit",name:"submit",className:"popup__save",children:e.buttonText})]})]})})};function y(e){return Object(u.jsx)(u.Fragment,{children:Object(u.jsxs)("fieldset",{className:"popup__fieldset",children:[Object(u.jsx)("input",{type:"url",name:"link",id:"link-update-input",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u0430\u0432\u0430\u0442\u0430\u0440",className:"popup__input popup__input_field_link",ref:e,required:!0}),Object(u.jsx)("span",{className:"popup__input-error",id:"link-update-input-error"})]})})}function N(e,t,n){return Object(u.jsxs)(u.Fragment,{children:[Object(u.jsxs)("fieldset",{className:"popup__fieldset",children:[Object(u.jsx)("input",{type:"text",name:"name",id:"name-profile-input",placeholder:"\u0418\u043c\u044f",className:"popup__input popup__input_field_username",minLength:"2",maxLength:"40",value:e||"",onChange:n,required:!0}),Object(u.jsx)("span",{className:"popup__input-error",id:"name-profile-input-error"})]}),Object(u.jsxs)("fieldset",{className:"popup__fieldset",children:[Object(u.jsx)("input",{type:"text",name:"info",id:"info-profile-input",placeholder:"\u041e \u0441\u0435\u0431\u0435",className:"popup__input popup__input_field_info",minLength:"2",maxLength:"200",value:t||"",onChange:n,required:!0}),Object(u.jsx)("span",{className:"popup__input-error",id:"info-profile-input-error"})]})]})}function S(e,t){return Object(u.jsxs)(u.Fragment,{children:[Object(u.jsxs)("fieldset",{className:"popup__fieldset",children:[Object(u.jsx)("input",{type:"text",name:"name",id:"name-newplace-input",placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",className:"popup__input popup__input_field_nameplace",minLength:"2",maxLength:"30",ref:e,required:!0}),Object(u.jsx)("span",{className:"popup__input-error",id:"name-newplace-input-error"})]}),Object(u.jsxs)("fieldset",{className:"popup__fieldset",children:[Object(u.jsx)("input",{type:"url",name:"link",id:"link-newplace-input",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",className:"popup__input popup__input_field_link",ref:t,required:!0}),Object(u.jsx)("span",{className:"popup__input-error",id:"link-newplace-input-error"})]})]})}var E=function(e){var t=i.a.useContext(d),n=i.a.useState(""),a=Object(o.a)(n,2),s=a[0],r=a[1],c=i.a.useState(""),l=Object(o.a)(c,2),p=l[0],h=l[1],_=e.isOpen,f=e.onClose,m=e.handleOverlay,j=i.a.useState("\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"),b=Object(o.a)(j,2),v=b[0],O=b[1];return i.a.useEffect((function(){r(t.name),h(t.about)}),[t]),Object(u.jsx)(C,{name:"profile",title:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",isOpen:_,onClose:f,children:N(s,p,(function(e){"name"===e.target.name?r(e.target.value):h(e.target.value)})),handleOverlay:m,buttonText:v,onSubmit:function(t){t.preventDefault(),O("\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435..."),e.onUpdateUser({name:s,about:p},O)}})};var L=function(e){var t=i.a.useRef(),n=i.a.useState("\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"),a=Object(o.a)(n,2),s=a[0],r=a[1],c=e.isOpen,l=e.onClose,p=e.handleOverlay;return Object(u.jsx)(C,{name:"avatar",title:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440",isOpen:c,onClose:l,children:y(t),handleOverlay:p,buttonText:s,onSubmit:function(n){n.preventDefault(),r("\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435..."),e.onUpdateAvatar({avatar:t.current.value},r,n.target)}})};var A=function(e){var t=i.a.useRef(),n=i.a.useRef(),a=i.a.useState("\u0421\u043e\u0437\u0434\u0430\u0442\u044c"),s=Object(o.a)(a,2),r=s[0],c=s[1],l=e.isOpen,p=e.onClose,d=e.handleOverlay;return Object(u.jsx)(C,{name:"newplace",title:"\u041d\u043e\u0432\u043e\u0435 \u043c\u0435\u0441\u0442\u043e",isOpen:l,onClose:p,children:S(t,n),handleOverlay:d,buttonText:r,onSubmit:function(a){a.preventDefault(),c("\u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435..."),e.onAddPlace({name:t.current.value,link:n.current.value},c,a.target)}})};var P=function(e){var t=i.a.useState("\u0414\u0430"),n=Object(o.a)(t,2),a=n[0],s=n[1],r=e.isOpen,c=e.onClose,l=e.handleOverlay;return Object(u.jsx)(C,{name:"confirm",title:"\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b?",buttonText:a,isOpen:r,onClose:c,handleOverlay:l,onSubmit:function(t){t.preventDefault(),e.onConfirm(t.target,s)}})};var T=function(){var e=i.a.useState({}),t=Object(o.a)(e,2),n=t[0],a=t[1],s=i.a.useState([]),r=Object(o.a)(s,2),l=r[0],h=r[1],_=i.a.useState([]),j=Object(o.a)(_,2),b=j[0],O=j[1];i.a.useEffect((function(){return k.getInitialCards().then((function(e){return h(e)})).catch((function(e){return alert(e)}))}),[]),i.a.useEffect((function(){k.getUserData().then((function(e){return a(e)})).catch((function(e){return alert(e)}))}),[]);var x=i.a.useState(!1),g=Object(o.a)(x,2),C=g[0],y=g[1],N=i.a.useState(!1),S=Object(o.a)(N,2),T=S[0],w=S[1],R=i.a.useState(!1),D=Object(o.a)(R,2),I=D[0],U=D[1],q=i.a.useState(!1),F=Object(o.a)(q,2),B=F[0],H=F[1],V=i.a.useState({name:"",link:""}),J=Object(o.a)(V,2),M=J[0],z=J[1],G=i.a.useState(!1),K=Object(o.a)(G,2),Q=K[0],W=K[1],X=i.a.useState(!1),Y=Object(o.a)(X,2),Z=Y[0],$=Y[1];function ee(e){27===e.keyCode&&te()}function te(){T&&w(!T),C&&y(!C),I&&U(!I),B&&H(!B),M.link&&z({name:"",link:""})}function ne(e){e.target===e.currentTarget&&te()}return i.a.useEffect((function(){return(T||C||I||""!==M.name)&&document.addEventListener("keydown",ee),function(){return document.removeEventListener("keydown",ee)}})),Object(u.jsx)(d.Provider,{value:n,children:Object(u.jsx)("div",{className:"page",children:Object(u.jsxs)("div",{className:"page__content",children:[Object(u.jsx)(p,{}),Object(u.jsx)(f,{isCardOpen:function(e){z({link:e.link,name:e.name})},onEditProfile:function(){w(!T)},onEditAvatar:function(){y(!C)},onAddPlace:function(){U(!I)},onHoverAvatar:function(){$(!Z),W(!Q)},isHover:Q,isVisible:Z,onCardDelete:function(e){H(!B),O(e)},onCardLike:function(e){var t=e.likes.some((function(e){return e._id===n._id}));k.changeLikeCardStatus(e._id,!t).then((function(t){return h((function(n){return n.map((function(n){return n._id===e._id?t:n}))}))}))},cards:l}),Object(u.jsx)(m,{}),Object(u.jsx)(E,{isOpen:T,onClose:te,onUpdateUser:function(e,t){k.editProfile(e).then((function(e){a(e),te(),t("\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c")})).catch((function(e){alert(e),t("\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c")}))},handleOverlay:ne}),Object(u.jsx)(L,{isOpen:C,onClose:te,handleOverlay:ne,onUpdateAvatar:function(e,t,n){k.editAvatar(e).then((function(e){a(e),te(),n.reset(),t("\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c")})).catch((function(e){alert(e),t("\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c")}))}}),Object(u.jsx)(A,{isOpen:I,onClose:te,handleOverlay:ne,onAddPlace:function(e,t,n){k.addNewCardServer(e).then((function(e){h([e].concat(Object(c.a)(l))),te(),n.reset(),t("\u0421\u043e\u0437\u0434\u0430\u0442\u044c")})).catch((function(e){alert(e),t("\u0421\u043e\u0437\u0434\u0430\u0442\u044c")}))}}),Object(u.jsx)(v,{onClose:te,card:M,isOpen:M.link,handleOverlay:ne}),Object(u.jsx)(P,{isOpen:B,onClose:te,handleOverlay:ne,onConfirm:function(e,t){t("\u0423\u0434\u0430\u043b\u0435\u043d\u0438\u0435..."),k.deleteCard(b._id).then((function(){h(l.filter((function(e){return e._id!==b._id}))),te(),t("\u0414\u0430")})).catch((function(e){alert(e),t("\u0414\u0430")}))}})]})})})},w=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,17)).then((function(t){var n=t.getCLS,a=t.getFID,i=t.getFCP,s=t.getLCP,r=t.getTTFB;n(e),a(e),i(e),s(e),r(e)}))};r.a.render(Object(u.jsx)(i.a.StrictMode,{children:Object(u.jsx)(T,{})}),document.getElementById("root")),w()},8:function(e,t,n){}},[[16,1,2]]]);
//# sourceMappingURL=main.4669dc76.chunk.js.map